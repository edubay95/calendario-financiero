name: Actualizar Calendario Financiero

# --- Disparadores (Cu谩ndo se ejecuta) ---
on:
  # 1. Un bot贸n para ejecutarlo manualmente
  workflow_dispatch:
  
  # 2. Programaci贸n autom谩tica (6:00 AM UTC todos los d铆as)
  schedule:
    - cron: '0 6 * * *'

# --- Tareas (Qu茅 hace el robot) ---
jobs:
  build-calendar:
    runs-on: ubuntu-latest # Usa un servidor Linux

    permissions:
          contents: write

    steps:
      # 1. Descarga tu c贸digo (el .py, .csv, .txt)
      - name: Checkout del c贸digo
        uses: actions/checkout@v4

      # 2. Configura Python
      - name: Configurar Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.10' # Usa Python 3.10

      # 3. Instala las librer铆as necesarias
      - name: Instalar dependencias
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements.txt
          pip install -r lxml_requirements.txt

      # 4. 隆Ejecuta tu script!
      - name: Ejecutar script de Python
        run: python generate_calendar.py

      # 5. Guarda los 3 archivos .ics nuevos en el repositorio
      - name: Commit de los archivos .ics
        uses: EndBug/add-and-commit@v9
        with:
          # El mensaje del "commit" (registro)
          message: ' Auto-actualizaci贸n de calendarios .ics'
          # Qu茅 archivos debe a帽adir (solo los .ics)
          add: '*.ics'
          # Fuerza el push para sobrescribir los antiguos
          push: 'true'
